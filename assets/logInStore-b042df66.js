import{a0 as m,a1 as i,a2 as c}from"./index-2b74f8b0.js";import{g as d,d as h,S as l,s as g,a as p,c as f,G as S,b as u,F as y,e as I,o as b,f as D}from"./dataStore-ed4c1e50.js";import{c as v}from"./cartStore-657aa4a9.js";const r=d(),e=h(),n=v(),a=l.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:s=>{s.addEventListener("mouseenter",l.stopTimer),s.addEventListener("mouseleave",l.resumeTimer)}}),P=m("logInStore",{state:()=>({logInPage:!0,logInForm:{user:{email:"",password:""}},signUpForm:{user:{displayName:"",email:"",password:"",confirmation:""}},AccountSettingState:!1,userProviderData:[],ProviderState:{password:!1,google:!1,facebook:!1,github:!1},resetPasswordEmail:""}),actions:{signOut(){g(r),i.push("/UserLogin"),e.courseData={},e.user={},e.isMember=!1,e.teacherData={uid:"",accountCreateTime:"",lastLogInTime:"",email:"",displayName:"",teacherImg:"",gender:"",birthday:"",address:"",phoneNumber:"",teachArea:[],teacherIntro:"",ckeditor:"",ckeditorImg:"",instagram:"",facebook:"",discord:"",expertise:"",educationalBackground:"",myTeachCourses:[],language:[],musicStyle:[],allTeachTime:0,studentAssess:[]},e.studentData={myStudyCourses:[],myCart:[],payHistory:[],allStudyTime:0,myBookmarkCourses:[],myBookmarkTeacher:[]},e.AllCoursesFirebaseData=[],e.otherTeacherData=[],e.beATeacherData={uid:"",displayName:"",gender:"",courseImg:"",courseName:"",courseIntro:"",courseCategory:"",courseMethod:[],cityName:"",time:0,price:0,timestamp:""},e.couponData=[],e.userTeacherCourses=[],e.userStudentCourses=[],e.userBookmarkCourses=[],e.userCartCourses=[],e.top6courses=[],e.youLikeCourses=[],n.couponCode="",n.couponValue=1,n.cartCheckboxWrap=[],n.payWrap={payData:[],total:0,finalTotal:0,couponUse:""},e.classScheduleData=[],e.classScheduleStudentData=[],e.classScheduleId="",e.classScheduleIndex=0,e.classScheduleTime="",e.calenderDataAll=[],e.calenderDataNameTemp="",this.userProviderData=[],this.ProviderState={password:!1,google:!1,facebook:!1,github:!1}},logIn(){p(r,this.logInForm.user.email,this.logInForm.user.password).then(()=>{e.isMember=!0,this.logInForm.user.email="",this.logInForm.user.password="",i.push("/"),a.fire({icon:"success",title:"恭喜登入成功"})}).catch(s=>{a.fire(s.message)})},async signUp(){await f(r,this.signUpForm.user.email,this.signUpForm.user.password).then(s=>{e.user=s.user,console.log(this.signUpForm.user.displayName),e.teacherData.displayName=this.signUpForm.user.displayName,console.log(e.teacherData.displayName),a.fire({icon:"success",title:"恭喜註冊成功"}),this.logInPage=!0,this.signUpForm.user.displayName="",this.signUpForm.user.email="",this.signUpForm.user.password="",this.signUpForm.user.confirmation="",e.SetFirebaseMemberData()}).catch(s=>{a.fire({icon:"error",title:s})})},async signInWithGoogle(){const s=new S;u(r,s).then(t=>{e.user=t.user,e.isMember=!0,console.log(this.AccountSettingState),this.AccountSettingState?(a.fire({timer:3e3,icon:"success",title:`Google帳號驗證成功，歡迎${t.user.displayName} `}),this.AccountSettingState=!1):(a.fire({timer:3e3,icon:"success",title:`登入成功，歡迎${t.user.displayName} `,text:`上次登入時間：${c(t.user.metadata.lastSignInTime).format("YYYY/MM/DD")}`}),t.user.metadata.creationTime===t.user.metadata.lastSignInTime?(console.log("第一次登入"),e.teacherData.displayName=t.user.displayName,e.SetFirebaseMemberData()):i.push("/"))}).catch(t=>{a.fire({icon:"error",title:t})})},async signInWithFacebook(){const s=new y;u(r,s).then(t=>{e.user=t.user,e.isMember=!0,console.log(this.AccountSettingState),this.AccountSettingState?(a.fire({timer:3e3,icon:"success",title:`Facebook帳號驗證成功，歡迎${t.user.displayName} `}),this.AccountSettingState=!1):(a.fire({timer:3e3,icon:"success",title:`登入成功，歡迎${t.user.displayName} `,text:`上次登入時間：${c(t.user.metadata.lastSignInTime).format("YYYY/MM/DD")}`}),t.user.metadata.creationTime===t.user.metadata.lastSignInTime?(console.log("第一次登入"),e.teacherData.displayName=t.user.displayName,e.SetFirebaseMemberData()):i.push("/"))}).catch(t=>{a.fire({icon:"error",title:t})})},async signInWithGithub(){const s=new I;u(r,s).then(t=>{e.user=t.user,e.isMember=!0,console.log(this.AccountSettingState),this.AccountSettingState?(a.fire({timer:3e3,icon:"success",title:`Google帳號驗證成功，歡迎${t.user.displayName} `}),this.AccountSettingState=!1):(a.fire({timer:3e3,icon:"success",title:`登入成功，歡迎${t.user.displayName} `,text:`上次登入時間：${c(t.user.metadata.lastSignInTime).format("YYYY/MM/DD")}`}),t.user.metadata.creationTime===t.user.metadata.lastSignInTime?(console.log("第一次登入"),e.teacherData.displayName=t.user.displayName,e.SetFirebaseMemberData()):i.push("/"))}).catch(t=>{a.fire({icon:"error",title:t})})},getCurrentUser(){b(r,s=>{if(s){console.log(132123);const t=r.currentUser;this.userProviderData=t.providerData,console.log(t),t!==null&&t.providerData.forEach(o=>{console.log(o.providerId),o.providerId==="password"?this.ProviderState.password=!0:o.providerId==="google.com"?this.ProviderState.google=!0:o.providerId==="facebook"?this.ProviderState.facebook=!0:o.providerId==="github"&&(this.ProviderState.github=!0)})}else console.log("已登出")})},updateUserEmail(){const s=r.currentUser;console.log(s)},sendEmailVerification(){},sendPasswordResetEmail(){D(r,this.resetPasswordEmail).then(()=>{a.fire({timer:3e3,icon:"success",title:"已送出密碼驗證信"}),this.resetPasswordEmail=""}).catch(s=>{a.fire({timer:3e3,icon:"error",title:s})}),this.resetPasswordEmail=""}}});export{P as l};
